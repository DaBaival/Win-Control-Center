import{f as oe,a as G,d as Ie}from"../chunks/sIloUZ-r.js";import{i as ga}from"../chunks/Bu5AYzux.js";import{o as ma}from"../chunks/DSc4XEBz.js";import{i as we,b as wa,c as ye,h as A,K as ya,a as xa,w as a,av as Ma,r as Sa,H as Ea,s as Pe,d as xe,k as ue,W as ka,ao as ba,a6 as Xe,e as ee,aK as Y,j as Te,l as Aa,R as $e,aG as U,am as De,aL as Ta,aM as Na,aN as Ia,aO as Da,f as aa,p as ta,aP as Me,ai as La,al as Ca,g as Va,V as Ra,aQ as Ba,aR as Ha,aS as Oa,aT as za,aU as Fa,aV as Ua,aI as ra,q as B,S as qa,aW as Ga,C as Wa,aX as Ya,aY as Ka,G as g,D as Se,F as Pa,ax as x,J as M,I as p,aZ as Je,a7 as Qe,x as Xa}from"../chunks/CGmmsghJ.js";import{d as $a,s as se,e as Ja,r as Qa}from"../chunks/i_KmMg29.js";import{i as Ee}from"../chunks/Cp5iFLRr.js";function Za(e,t,r){for(var v=[],c=t.length,l,f=t.length,i=0;i<c;i++){let h=t[i];ta(h,()=>{if(l){if(l.pending.delete(h),l.done.add(h),l.pending.size===0){var m=e.outrogroups;Ne(De(l.done)),m.delete(l),m.size===0&&(e.outrogroups=null)}}else f-=1},!1)}if(f===0){var d=v.length===0&&r!==null;if(d){var u=r,_=u.parentNode;Ca(_),_.append(u),e.items.clear()}Ne(t,!d)}else l={pending:new Set(t),done:new Set},(e.outrogroups??(e.outrogroups=new Set)).add(l)}function Ne(e,t=!0){for(var r=0;r<e.length;r++)Va(e[r],t)}var Ze;function ja(e,t,r,v,c,l=null){var f=e,i=new Map;{var d=e;f=A?ye(ya(d)):d.appendChild(we())}A&&xa();var u=null,_=Ma(()=>{var E=r();return Ta(E)?E:E==null?[]:De(E)}),h,m=!0;function H(){S.fallback=u,et(S,h,f,t,v),u!==null&&(h.length===0?(u.f&Y)===0?aa(u):(u.f^=Y,le(u,null,f)):ta(u,()=>{u=null}))}var o=wa(()=>{h=a(_);var E=h.length;let N=!1;if(A){var T=Sa(f)===Ea;T!==(E===0)&&(f=Pe(),ye(f),xe(!1),N=!0)}for(var K=new Set,I=ee,O=Aa(),D=0;D<E;D+=1){A&&ue.nodeType===ka&&ue.data===ba&&(f=ue,N=!0,xe(!1));var P=h[D],z=v(P,D),y=m?null:i.get(z);y?(y.v&&Xe(y.v,P),y.i&&Xe(y.i,D),O&&I.skipped_effects.delete(y.e)):(y=at(i,m?f:Ze??(Ze=we()),P,z,D,c,t,r),m||(y.e.f|=Y),i.set(z,y)),K.add(z)}if(E===0&&l&&!u&&(m?u=Te(()=>l(f)):(u=Te(()=>l(Ze??(Ze=we()))),u.f|=Y)),A&&E>0&&ye(Pe()),!m)if(O){for(const[fe,X]of i)K.has(fe)||I.skipped_effects.add(X.e);I.oncommit(H),I.ondiscard(()=>{})}else H();N&&xe(!0),a(_)}),S={effect:o,items:i,outrogroups:null,fallback:u};m=!1,A&&(f=ue)}function et(e,t,r,v,c){var z;var l=t.length,f=e.items,i=e.effect.first,d,u=null,_=[],h=[],m,H,o,S;for(S=0;S<l;S+=1){if(m=t[S],H=c(m,S),o=f.get(H).e,e.outrogroups!==null)for(const y of e.outrogroups)y.pending.delete(o),y.done.delete(o);if((o.f&Y)!==0)if(o.f^=Y,o===i)le(o,null,r);else{var E=u?u.next:i;o===e.effect.last&&(e.effect.last=o.prev),o.prev&&(o.prev.next=o.next),o.next&&(o.next.prev=o.prev),W(e,u,o),W(e,o,E),le(o,E,r),u=o,_=[],h=[],i=u.next;continue}if((o.f&Me)!==0&&aa(o),o!==i){if(d!==void 0&&d.has(o)){if(_.length<h.length){var N=h[0],T;u=N.prev;var K=_[0],I=_[_.length-1];for(T=0;T<_.length;T+=1)le(_[T],N,r);for(T=0;T<h.length;T+=1)d.delete(h[T]);W(e,K.prev,I.next),W(e,u,K),W(e,I,N),i=N,u=I,S-=1,_=[],h=[]}else d.delete(o),le(o,i,r),W(e,o.prev,o.next),W(e,o,u===null?e.effect.first:u.next),W(e,u,o),u=o;continue}for(_=[],h=[];i!==null&&i!==o;)(d??(d=new Set)).add(i),h.push(i),i=i.next;if(i===null)continue}(o.f&Y)===0&&_.push(o),u=o,i=o.next}if(e.outrogroups!==null){for(const y of e.outrogroups)y.pending.size===0&&(Ne(De(y.done)),(z=e.outrogroups)==null||z.delete(y));e.outrogroups.size===0&&(e.outrogroups=null)}if(i!==null||d!==void 0){var O=[];if(d!==void 0)for(o of d)(o.f&Me)===0&&O.push(o);for(;i!==null;)(i.f&Me)===0&&i!==e.fallback&&O.push(i),i=i.next;var D=O.length;if(D>0){var P=l===0?r:null;Za(e,O,P)}}}function at(e,t,r,v,c,l,f,i){var d=(f&Na)!==0?(f&Ia)===0?U(r,!1,!1):$e(r):null,u=(f&Da)!==0?$e(c):null;return{v:d,i:u,e:Te(()=>(l(t,d??r,u??c,i),()=>{e.delete(v)}))}}function le(e,t,r){if(e.nodes)for(var v=e.nodes.start,c=e.nodes.end,l=t&&(t.f&Y)===0?t.nodes.start:r;v!==null;){var f=La(v);if(l.before(v),v===c)return;v=f}}function W(e,t,r){t===null?e.effect.first=r:t.next=r,r===null?e.effect.last=t:r.prev=t}function tt(e,t,r){var v=e==null?"":""+e;return v=v?v+" "+t:t,v===""?null:v}function rt(e,t){return e==null?null:String(e)}function ke(e,t,r,v,c,l){var f=e.__className;if(A||f!==r||f===void 0){var i=tt(r,v);(!A||i!==e.getAttribute("class"))&&(i==null?e.removeAttribute("class"):e.className=i),e.__className=r}return l}function st(e,t,r,v){var c=e.__style;if(A||c!==t){var l=rt(t);(!A||l!==e.getAttribute("style"))&&(l==null?e.removeAttribute("style"):e.style.cssText=l),e.__style=t}return v}const nt=Symbol("is custom element"),it=Symbol("is html");function ne(e){if(A){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var v=e.value;ce(e,"value",null),e.value=v}if(e.hasAttribute("checked")){var c=e.checked;ce(e,"checked",null),e.checked=c}}};e.__on_r=r,Ra(r),Ba()}}function ce(e,t,r,v){var c=lt(e);A&&(c[t]=e.getAttribute(t),t==="src"||t==="srcset"||t==="href"&&e.nodeName==="LINK")||c[t]!==(c[t]=r)&&(t==="loading"&&(e[za]=r),r==null?e.removeAttribute(t):typeof r!="string"&&ot(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function lt(e){return e.__attributes??(e.__attributes={[nt]:e.nodeName.includes("-"),[it]:e.namespaceURI===Ha})}var je=new Map;function ot(e){var t=e.getAttribute("is")||e.nodeName,r=je.get(t);if(r)return r;je.set(t,r=[]);for(var v,c=e,l=Element.prototype;l!==c;){v=Fa(c);for(var f in v)v[f].set&&r.push(f);c=Oa(c)}return r}function ie(e,t,r=t){var v=new WeakSet;Ua(e,"input",async c=>{var l=c?e.defaultValue:e.value;if(l=be(e)?Ae(l):l,r(l),ee!==null&&v.add(ee),await ra(),l!==(l=t())){var f=e.selectionStart,i=e.selectionEnd,d=e.value.length;if(e.value=l??"",i!==null){var u=e.value.length;f===i&&i===d&&u>d?(e.selectionStart=u,e.selectionEnd=u):(e.selectionStart=f,e.selectionEnd=Math.min(i,u))}}}),(A&&e.defaultValue!==e.value||B(t)==null&&e.value)&&(r(be(e)?Ae(e.value):e.value),ee!==null&&v.add(ee)),qa(()=>{var c=t();if(e===document.activeElement){var l=Ga??ee;if(v.has(l))return}be(e)&&c===Ae(e.value)||e.type==="date"&&!c&&!e.value||c!==e.value&&(e.value=c??"")})}function be(e){var t=e.type;return t==="number"||t==="range"}function Ae(e){return e===""?null:+e}async function b(e,t={},r){return window.__TAURI_INTERNALS__.invoke(e,t,r)}function ea(e,t="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(e,t)}var vt=Ie('<path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path><path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>',1),ut=Ie('<line x1="23" y1="9" x2="17" y2="15"></line><line x1="17" y1="9" x2="23" y2="15"></line>',1),ct=Ie('<line x1="1" y1="1" x2="23" y2="23"></line>'),ft=oe('<img class="app-icon svelte-1uha8ag" alt=""/>'),dt=oe('<div class="app-icon-fallback svelte-1uha8ag"><svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg></div>'),_t=oe('<div class="app-row svelte-1uha8ag"><div style="cursor: pointer;"><!></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div>'),ht=oe('<div class="loading svelte-1uha8ag">Scanning sessions...</div>'),pt=oe('<main class="svelte-1uha8ag"><section class="merged-controls svelte-1uha8ag"><div class="control-row svelte-1uha8ag"><div title="System Volume" style="cursor: pointer;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"></path><!></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div title="Microphone" style="cursor: pointer;"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"></path><path d="M19 10v2a7 7 0 0 1-14 0v-2"></path><line x1="12" y1="19" x2="12" y2="22"></line><line x1="8" y1="22" x2="16" y2="22"></line><!></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="Brightness"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"></circle><path d="M12 2v2"></path><path d="M12 20v2"></path><path d="M4.93 4.93l1.41 1.41"></path><path d="M17.66 17.66l1.41 1.41"></path><path d="M2 12h2"></path><path d="M20 12h2"></path><path d="M4.93 19.07l1.41-1.41"></path><path d="M17.66 6.34l1.41-1.41"></path></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="0" max="100" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div> <div class="control-row svelte-1uha8ag"><div class="icon-box svelte-1uha8ag" title="Mouse Speed"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="2" width="14" height="20" rx="7"></rect><path d="M12 6v4"></path></svg></div> <div class="slider-container svelte-1uha8ag"><input type="range" min="1" max="20" class="svelte-1uha8ag"/> <span class="value-badge svelte-1uha8ag"> </span></div></div></section> <section class="app-section svelte-1uha8ag"><div class="app-list svelte-1uha8ag"></div></section></main>');function St(e,t){Wa(t,!1);let r=U(0),v=U(!1),c=U(0),l=U(!1),f=U(100),i=U(10),d=U([]),u,_=0,h=!1,m=U(!1),H=!1;async function o(){await ra();const s=document.querySelector("main");if(s){const n=s.offsetHeight;try{await b("resize_window",{height:n})}catch(w){console.error(w)}}}function S(s,n){let w;return function(...k){clearTimeout(w),w=setTimeout(()=>s.apply(this,k),n)}}const E=S(async s=>{try{await b("set_system_volume",{vol:s/100})}catch(n){console.error(n)}},50),N=S(async s=>{try{await b("set_mic_volume",{vol:s/100})}catch(n){console.error(n)}},50),T=S(async s=>{try{await b("set_brightness",{val:s/100})}catch(n){console.error(n)}},50),K=S(async s=>{try{await b("set_mouse_speed",{val:Math.round(s)})}catch(n){console.error(n)}},100),I=S(async(s,n)=>{try{await b("set_app_volume",{pid:s,vol:n/100})}catch(w){console.error(w)}},50);function O(){_=Date.now(),E(a(r))}function D(){_=Date.now(),N(a(c))}function P(){_=Date.now(),T(a(f))}function z(){_=Date.now(),K(a(i))}function y(s,n){_=Date.now();const w=a(d).find(k=>k.pid===s);w&&(w.volume_display=n,w.volume=n/100,x(d,a(d))),I(s,n)}async function fe(s,n){_=Date.now();const w=a(d).find(k=>k.pid===s);w&&(w.is_muted=!n,x(d,a(d)));try{await b("set_app_mute",{pid:s,mute:!n})}catch(k){console.error(k)}}function X(){h=!0,_=Date.now()}function ae(){h=!1,_=Date.now()}async function sa(){_=Date.now(),x(v,!a(v));try{await b("set_system_mute",{mute:a(v)})}catch(s){console.error(s)}}async function na(){_=Date.now(),x(l,!a(l));try{await b("set_mic_mute",{mute:a(l)})}catch(s){console.error(s)}}async function Le(){if(!H&&!(a(m)&&Date.now()-_<3e3)){H=!0;try{const s=await Promise.allSettled([b("get_system_volume"),b("get_mic_volume"),b("get_brightness"),b("get_mouse_speed"),b("get_app_volumes")]);if(h)return;const[n,w,k,F,ve]=s;if(n.status==="fulfilled"){const[L,C]=n.value,q=L*100;(!a(m)||Math.abs(q-a(r))>1||a(v)!==C)&&(x(r,q),x(v,C))}if(w.status==="fulfilled"){const[L,C]=w.value,q=L*100;(!a(m)||Math.abs(q-a(c))>1||a(l)!==C)&&(x(c,q),x(l,C))}if(k.status==="fulfilled"){const L=k.value*100;(!a(m)||Math.abs(L-a(f))>1)&&x(f,L)}if(F.status==="fulfilled"&&x(i,F.value),ve.status==="fulfilled"){const L=ve.value.map(C=>({...C,volume_display:Math.round(C.volume*100)}));h||x(d,L)}a(m)||(x(m,!0),o())}catch(s){console.error("Load State Error:",s)}finally{H=!1}}}ma(()=>{Le(),u=setInterval(()=>{Le()},2500);const s=()=>{h&&(h=!1)};return window.addEventListener("pointerup",s),window.addEventListener("blur",s),()=>{u&&clearInterval(u),window.removeEventListener("pointerup",s),window.removeEventListener("blur",s)}}),Ya(()=>(a(m),a(d)),()=>{a(m)&&a(d)&&o()}),Ka(),ga();var de=pt(),_e=g(de),he=g(_e),te=g(he);te.__click=sa;var Ce=g(te),ia=M(g(Ce));{var la=s=>{var n=vt();Qe(),G(s,n)},oa=s=>{var n=ut();Qe(),G(s,n)};Ee(ia,s=>{a(v)?s(oa,!1):s(la)})}p(Ce),p(te);var Ve=M(te,2),$=g(Ve);ne($),$.__input=O,$.__pointerdown=X,$.__pointerup=ae;var Re=M($,2),va=g(Re,!0);p(Re),p(Ve),p(he);var pe=M(he,2),re=g(pe);re.__click=na;var Be=g(re),ua=M(g(Be),4);{var ca=s=>{var n=ct();G(s,n)};Ee(ua,s=>{a(l)&&s(ca)})}p(Be),p(re);var He=M(re,2),J=g(He);ne(J),J.__input=D,J.__pointerdown=X,J.__pointerup=ae;var Oe=M(J,2),fa=g(Oe,!0);p(Oe),p(He),p(pe);var ge=M(pe,2),ze=M(g(ge),2),Q=g(ze);ne(Q),Q.__input=P,Q.__pointerdown=X,Q.__pointerup=ae;var Fe=M(Q,2),da=g(Fe,!0);p(Fe),p(ze),p(ge);var Ue=M(ge,2),qe=M(g(Ue),2),Z=g(qe);ne(Z),Z.__input=z,Z.__pointerdown=X,Z.__pointerup=ae;var Ge=M(Z,2),_a=g(Ge,!0);p(Ge),p(qe),p(Ue),p(_e);var We=M(_e,2),Ye=g(We);ja(Ye,5,()=>a(d),s=>s.pid+s.name,(s,n,w)=>{var k=_t(),F=g(k);F.__click=()=>fe(a(n).pid,a(n).is_muted);var ve=g(F);{var L=V=>{var R=ft();Se(me=>{st(R,`filter: ${a(n),B(()=>a(n).is_muted?"grayscale(1) opacity(0.5)":"none")??""}`),ce(R,"src",me)},[()=>(a(n),Xa(ea),B(()=>a(n).icon_path.startsWith("data:")?a(n).icon_path:ea(a(n).icon_path)))]),Ja("error",R,me=>{const pa=me.currentTarget;pa.style.display="none"}),Qa(R),G(V,R)},C=V=>{var R=dt();G(V,R)};Ee(ve,V=>{a(n),B(()=>a(n).icon_path&&a(n).icon_path!=="")?V(L):V(C,!1)})}p(F);var q=M(F,2),j=g(q);ne(j),j.__input=V=>{const R=V.currentTarget.valueAsNumber;a(n).volume=R/100,Je(()=>a(d)),y(a(n).pid,R)},j.__pointerdown=X,j.__pointerup=ae;var Ke=M(j,2),ha=g(Ke,!0);p(Ke),p(q),p(k),Se(()=>{ke(F,1,`icon-box ${a(n),B(()=>a(n).is_muted?"muted":"")??""}`,"svelte-1uha8ag"),ce(F,"title",(a(n),B(()=>a(n).name))),se(ha,(a(n),B(()=>a(n).volume_display)))}),ie(j,()=>a(n).volume_display,V=>(a(n).volume_display=V,Je(()=>a(d)))),G(s,k)},s=>{var n=ht();G(s,n)}),p(Ye),p(We),p(de),Se((s,n,w)=>{ke(te,1,`icon-box ${a(v)?"muted":""}`,"svelte-1uha8ag"),se(va,s),ke(re,1,`icon-box ${a(l)?"muted":""}`,"svelte-1uha8ag"),se(fa,n),se(da,w),se(_a,a(i))},[()=>(a(r),B(()=>Math.round(a(r)))),()=>(a(c),B(()=>Math.round(a(c)))),()=>(a(f),B(()=>Math.round(a(f))))]),ie($,()=>a(r),s=>x(r,s)),ie(J,()=>a(c),s=>x(c,s)),ie(Q,()=>a(f),s=>x(f,s)),ie(Z,()=>a(i),s=>x(i,s)),G(e,de),Pa()}$a(["click","input","pointerdown","pointerup"]);export{St as component};
